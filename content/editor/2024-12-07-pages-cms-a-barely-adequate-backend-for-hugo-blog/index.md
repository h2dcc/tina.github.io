---
title: Pages CMSï¼šä¸€ä¸ªå‹‰å¼ºå¤Ÿç”¨çš„HUGOåšå®¢åå°
draft: false
slug: pages-cms-a-barely-adequate-backend-for-hugo-blog
date: 2024-12-06T11:41:00
categories:
  - ITäº’è”ç½‘
tags:
  - åšå®¢
  - Hugo
  - PagesCMS
image: 0.webp
---
> ä» WordPress è¿ç§»åˆ° Hugo åï¼Œæˆ‘ä¸€ç›´å¯¹ WordPress åå°ç®¡ç†ä»¥åŠæ‰‹æœº APP çš„ä¾¿åˆ©æ€§å¿µå¿µä¸å¿˜ï¼Œä¸ºæ­¤æˆ‘åœ¨ä¹‹å‰ä¹Ÿå†™è¿‡å…³äº [å¦‚ä½•åœ¨æ‰‹æœºä¸Šæ›´æ–°Hugoåšå®¢](https://hyruo.com/article/how-to-update-a-hugo-blog-on-an-android-phone/) çš„æ–‡ç« ï¼Œä½†æ˜¯åœ¨æ‰‹æœºä¸Šä½¿ç”¨ Vscode å’Œ StackEdit è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œä¸»è¦æ˜¯æ˜¾ç¤ºå±å¤ªå°ï¼Œä¸€äº›ç²¾ç»†åŒ–æ“ä½œå¾ˆéš¾ç”¨æ‰‹æŒ‡è§¦æ§è§£å†³ã€‚è¿‡ç¨‹ä¸­æˆ‘ä¹Ÿå°è¯•è¿‡å‡ ç§ Hugo CMS æ–¹æ¡ˆï¼Œä½†ä¸€ç›´æœªæ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚

* * *

## å‡ æ¬¡å¤±è´¥çš„å°è¯•

### Decap CMS

Decap CMS ä»¥å‰åˆå« Netlify CMSï¼Œçœ‹åå­—å°±çŸ¥é“è·Ÿ Netlify æœ‰ç€å¾ˆå¼ºçš„å…³è”ã€‚å®ƒé»˜è®¤éƒ¨ç½²æ–¹å¼å°±æ˜¯åœ¨ Netlify ä¸Šï¼Œä½†æ˜¯ç”±äºæˆ‘ä¸€ç›´æ²¡èƒ½æ³¨å†Œåˆ° Netlify è´¦å·ï¼Œäºæ˜¯æˆ‘åªèƒ½åœ¨ç”²éª¨æ–‡æœåŠ¡å™¨ä¸Šè¿›è¡Œæµ‹è¯•ã€‚ä½†åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°å®ƒçš„åå°é…ç½®éå¸¸éº»çƒ¦ï¼Œä¹Ÿè®¸åªæœ‰ä½¿ç”¨ Netlify éƒ¨ç½²æ‰èƒ½ä½“ç°å‡ºå®ƒçš„ä¾¿åˆ©æ€§ï¼Œä¹‹åæˆ‘ä¾¿æç½®æµ‹è¯•äº†ã€‚

![Decap CMS](1.webp)

### QUIQR

QUIQR æ˜¯ä¸€æ¬¾æœ¬åœ°åŒ–è½¯ä»¶ï¼Œå¯ä»¥ç›´æ¥åœ¨ Windows å®‰è£…ã€‚ä½†æ˜¯å®ƒå¹¶ä¸æ”¯æŒ Web ç‰ˆï¼Œä¹Ÿæ²¡æœ‰æ‰‹æœº APPï¼Œè¿™å°±ä½¿å¾—å®ƒæ²¡æ³•åœ¨æ‰‹æœºä¸Šä½¿ç”¨ã€‚ä¸æˆ‘é¢„æœŸç›®çš„ä¸ç¬¦ã€‚

![Quiqr CMS](4.webp)

### Tina CMS

Tina CMS ä¹‹å‰åˆå« Forestry CMS ä¹Ÿæ˜¯ä¸€æ¬¾æ— å¤´ç¼–è¾‘å™¨ï¼Œä½†æˆ‘ä¸å®ƒæ— ç¼˜ï¼Œå³ä¾¿æˆ‘å·²ç»è®¾ç½®å¥½ Tina Cloud è´¦å·å¹¶æ·»åŠ é¡¹ç›®ï¼Œä½†æ˜¯æˆ‘ä¸€ç›´å¡åœ¨æœ¬åœ° Tina å®‰è£…ä¸Šè¾¹ã€‚ä¸çŸ¥é“æ˜¯æˆ‘çš„ç½‘ç»œé—®é¢˜è¿˜æ˜¯æ€ä¹ˆï¼Œæˆ‘åœ¨ä¸¤å°ç”µè„‘ä¸Šéƒ½æ²¡èƒ½æˆåŠŸå®‰è£… Tina ç¨‹åºã€‚

![Tina å®‰è£…å¤±è´¥](2.webp)

* * *

## Pages CMS

Pages CMS æ˜¯ Github ä¸Šä¸€ä¸ªæ–°çš„å¼€æºé¡¹ç›®ï¼Œåœ¨ 0.x ç‰ˆæœ¬æ—¶ï¼Œå¯ä»¥é€‰æ‹©åœ¨ Cloudflare å¿«æ·éƒ¨ç½²ã€‚æœ€è¿‘å‡çº§äº† 1.0 ç‰ˆæœ¬ï¼Œé»˜è®¤å¯åœ¨ Vercel éƒ¨ç½²ã€‚ä¹‹å‰åœ¨ 0.x ç‰ˆæœ¬æ—¶æˆ‘æ›¾è¯•è¿‡ç”¨ä¸€æ¬¡ï¼Œå½“æ—¶ä¸»è¦é—®é¢˜æ˜¯è¯¥ CMS ä¸æ”¯æŒ webp å›¾ç‰‡ï¼Œæˆ‘åœ¨é¡¹ç›®æäº¤äº† issueï¼Œä»Šæ—©æ”¶åˆ°å¼€å‘è€…å›å¤è¯´æœ€æ–°ç‰ˆæœ¬å·²ç»è§£å†³è¯¥é—®é¢˜ã€‚

äºæ˜¯å…´å†²å†²åœ°æŒ‰æ–‡æ¡£éƒ¨ç½²äº† 1.0 ç‰ˆæœ¬ï¼Œè¿‡ç¨‹è¿˜æ˜¯ç›¸å¯¹å¤æ‚ä½†ä¹Ÿé¡ºåˆ©ã€‚å¯æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªé—®é¢˜æˆ‘å§‹ç»ˆ [æ— æ³•è§£å†³](https://github.com/pages-cms/pages-cms/issues/129)

> æˆ‘çš„ hugo åšå®¢æ–‡ä»¶éƒ½æ˜¯åœ¨ `content/posts` ä¸‹è¾¹çš„å•ä¸ªæ–‡ä»¶å¤¹ï¼Œåšå®¢å›¾ç‰‡è·Ÿ md æ–‡ä»¶åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹å†…ã€‚æˆ‘å¥½ä¸å®¹æ˜“è§£å†³äº†æ­£æ–‡ä¸­å›¾ç‰‡çš„ä¸Šä¼ å’Œå¼•ç”¨é—®é¢˜ï¼Œä½†æ˜¯ front-matter ä¸­è‡ªåŠ¨ç”Ÿæˆçš„ç‰¹è‰²å›¾ç‰‡åœ°å€æ²¡æ³•è¢« hugo æ¸²æŸ“ã€‚

äºæ˜¯æˆ‘æäº¤äº†è¿™ä¸ª issue å‘å¼€å‘è€…åæ˜ ã€‚ä½†å¼€å‘è€…ä¹Ÿè¯´ä»–è‡ªå·±æš‚æ—¶æ²¡åŠæ³•è§£å†³ï¼Œè€Œä¸”ä¹‹å‰å·²ç»æœ‰å‡ ä¸ªäººæå‡ºè¿‡ç±»ä¼¼é—®é¢˜ï¼Œéƒ½æ˜¯å¡åœ¨ Hugo çš„æ–‡ä»¶è·¯å¾„ä¸Šã€‚

è§åˆ°å¼€å‘è€…çš„å›å¤åï¼Œæˆ‘ä¸€åº¦å·²ç»æ”¾å¼ƒç»§ç»­ä½¿ç”¨ CMS çš„æƒ³æ³•ã€‚

> Thank you, I'm completely heartbroken. I'll just keep using some IDE tools like VSCode, but it's really inconvenient on a phone.

è§åˆ°å¼€å‘è€…å›å¤åï¼Œæˆ‘çªç„¶æƒ³åˆ°ï¼Œä¸ºå•¥ä¸€å®šè¦å°† Hugo çš„ç‰¹è‰²å›¾ç‰‡è·¯å¾„äº¤ç”± CMS å»è½¬æ¢å‘¢ï¼Œæˆ‘è‡ªå·±ç›´æ¥è¾“å…¥ä¸€ä¸ªè·¯å¾„ä¸å°±è§£å†³äº†ã€‚

### åŸæ–¹æ¡ˆï¼Œä½¿ç”¨ Pages CMS è‡ªåŠ¨è½¬æ¢

```
media:
  input: content/posts
  output: /content/posts 
content:
     ...
      - name: image
        label: Image
        type: image
        list: true
        options:
          input: content/posts
          output: /content/posts
```

### æ–°æ–¹æ¡ˆï¼Œå…ˆè®¾ç½®ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ åŒºåŸŸï¼Œå†è‡ªè¡Œè¾“å…¥ç‰¹è‰²å›¾ç‰‡åœ°å€

```
media:
  input: content/posts
  output: /content/posts 
content:
     ...
      - name: uploadimage
        label: Uploadimage
        type: object
        list: true
        fields:
          - name: newimage
            label: newimage
            type: image
            options:
              input: content/post
              output: content/post
              categories: [image]
      - { name: image, label: image, type: string, required: true }
```

è¿™æ ·ï¼Œèµ·ç è§£å†³äº† Hugo ç‰¹è‰²å›¾ç‰‡è·¯å¾„é”™è¯¯é—®é¢˜ã€‚ä½†å…¶å®ä¹Ÿå¸¦æ¥ä¸€ä¸ªæ–°é—®é¢˜ï¼Œå°±æ˜¯åœ¨ Pages CMS åå°ï¼Œæ²¡æ³•åœ¨æ–‡å­—ç¼–è¾‘åŒºçœ‹åˆ°å›¾ç‰‡å†…å®¹äº†ã€‚åœ¨ä½¿ç”¨ `![](image.webp)` è¯­æ³•åï¼Œç¼–è¾‘åŒºé‡Œå›¾ç‰‡ç›´æ¥æ¶ˆå¤±ã€‚åœ¨æ·»åŠ å›¾ç‰‡åç§°åï¼Œç¨å¾®å¥½ç‚¹ï¼Œèµ·ç çŸ¥é“è¿™ä¸ªä½ç½®æœ‰ä¸ªå›¾ç‰‡äº†ã€‚

![æ˜¾ç¤ºé”™è¯¯ä½†ä¸å½±å“ä½¿ç”¨](3.webp)

å¦‚æœç›´æ¥åœ¨åå°æŒ‰ `/` å‘¼å‡ºç¼–è¾‘å™¨å†…çš„å›¾ç‰‡åŠŸèƒ½æ·»åŠ å›¾ç‰‡ï¼Œè™½ç„¶åœ¨ç¼–è¾‘å™¨å†…å¯ä»¥çœ‹åˆ°å›¾ç‰‡é•¿å•¥æ ·ï¼Œä½† PagesCMS ä¼šè‡ªåŠ¨åŒ¹é…å›¾ç‰‡è·¯å¾„ä¸º `/content/post/articl-pyth/image.webp`ï¼Œä¹Ÿæ˜¯æ²¡æ³•ç”¨çš„ï¼ŒHugo æ„å»ºåå›¾ç‰‡è‚¯å®šæŒ‚ã€‚

ä½†æ— è®ºå¦‚ä½•ï¼Œç»ˆäºç®—æ˜¯åŸºæœ¬æ­å»ºå¥½ä¸€ä¸ªèƒ½å¤Ÿç»™ Hugo ä½¿ç”¨çš„ CMS åå°ã€‚

* * *

### Github ä¿®æ”¹è‡ªåŠ¨éƒ¨ç½²

ç›¸æ¯” StackEdit å¯ä»¥æ‰‹åŠ¨æš‚åœåŒæ­¥çš„åšæ³•ï¼ŒPageCMS è¿™ç±»ç¨‹åºï¼Œä¼šåœ¨æ¯ä¸€æ¬¡ä¿å­˜ `.pages.yml` æ–‡ä»¶ï¼Œæ¯ä¸€æ¬¡ä¸Šä¼ å›¾ç‰‡ï¼Œæ¯ä¸€æ¬¡ä¿å­˜æ–‡ç« å†…å®¹çš„è¿‡ç¨‹ä¸­éƒ½æäº¤æ›´æ–°åˆ° Github ä¸Šï¼Œè¿™æ ·ä¼šé€ æˆ Github Actions æˆ–è€… Cloudflare Pages, Vercel ç­‰è‡ªåŠ¨éƒ¨ç½²æœåŠ¡åœ¨åå°ä¸æ–­æ¶ˆè€—éƒ¨ç½²æ—¶é•¿ã€‚æˆ‘æœ¬ä»¥ä¸ºæ–°å»ºä¸€ä¸ª test åˆ†æ”¯ä¼šé¿å…è¿™ä¸ªé—®é¢˜ï¼Œç»“æœæ²¡æƒ³åˆ°è¿˜æ˜¯åœ¨è°ƒè¯• `.pages.yml` æ–‡ä»¶æ—¶ï¼Œè¿ç»­è§¦å‘ Vercel å››åå¤šæ¬¡è‡ªåŠ¨éƒ¨ç½²ï¼Œæ„Ÿè§‰å†å¤šç‚¹è´¦å·éƒ½å¾—è¢«å¹²åºŸäº†ã€‚

![Vercel é¢‘ç¹éƒ¨ç½²](5.webp)

1. **Vercel å¿½ç•¥éƒ¨ç½²è®¾ç½®**

åœ¨ `Vercel Setting Git` ä¸­ï¼Œæœ‰ä¸€ä¸ªå¿½ç•¥æ„å»ºé€‰é¡¹ï¼Œé€‰æ‹© `custom` å¹¶åœ¨å…¶ä¸­æ·»åŠ å¦‚ä¸‹å‘½ä»¤å³å¯ã€‚

```
if git log -1 --pretty=%B | grep -iqF 'webp'; then echo "ğŸ›‘ - Build cancelled (commit message contains 'webp')"; exit 0; else echo "âœ… - Build can proceed"; exit 1; fi
```


> åŸç†ï¼šåœ¨ PageCMS ä¸­æ·»åŠ å›¾ç‰‡ï¼ŒPageCMS ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€æ¡ `Create content/editor/2024-12-07-pages-cms-a-barely-adequate-backend-for-hugo-blog/6.webp (via Pages CMS)` è¿™æ ·çš„æäº¤ä¿¡æ¯ï¼Œå…¶ä¸­å…³é”®è¯å°±æ˜¯å›¾ç‰‡æ ¼å¼äº†ã€‚æ‰€ä»¥åœ¨ Vcel å¿½ç•¥æ„å»ºå‘½ä»¤ä¸­åªè¦æ£€æµ‹åˆ°æäº¤ä¿¡æ¯åŒ…å« webp å³å¿½ç•¥éƒ¨ç½²ï¼ˆä»¥åå‘½åæ–‡ä»¶è·¯å¾„æ—¶æœ€å¥½å°±ä¸è¦å°† webp å†™è¿›å»äº†ï¼‰ã€‚

2.  **Github Actions å¿½ç•¥éƒ¨ç½²è®¾ç½®**
    

ç›¸åŒåŸç†ï¼Œåœ¨ Workflow çš„éƒ¨ç½²æ¨¡æ¿ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œä¾¦æµ‹æ˜¯å¦ä»…æäº¤ webp å›¾ç‰‡ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œä¸å¯åŠ¨è‡ªåŠ¨æ„å»ºã€‚ä½†è¯¥æ–¹æ³•ä¼¼ä¹æ— æ•ˆã€‚

```
      - name: Check for non-WebP images  # æ·»åŠ åœ¨ built ä¸­
        id: check_images
        run: |
          if git diff --name-only HEAD^ | grep -vE '\.webp$' > /dev/null; then
            echo "Non-WebP images detected. Proceeding with deployment."
            echo "::set-output name=deploy::true"
          else
            echo "Only WebP images detected. Skipping deployment."
            echo "::set-output name=deploy::false"
          fi

      if: steps.check_images.outputs.deploy == 'true' # æ·»åŠ åœ¨ deploy ä¸­
```

3.  **Cloudflare Pages å¿½ç•¥éƒ¨ç½²è®¾ç½®**
    

æš‚æœªæ‰¾åˆ°åˆé€‚æ–¹æ³•ã€‚ä¸è¿‡ Cloudflare è´¢å¤§æ°”ç²—ï¼Œå¯èƒ½ä¹Ÿä¸åœ¨ä¹å¤šæ„å»ºå‡ æ¬¡ã€‚

* * *

## PagesCMS è®¾ç½®

æœ€åä¼ ä¸Šæˆ‘è‡ªå·±çš„ PagesCMS ä¾›å‚è€ƒã€‚

```
media:
  input: content/editor
  output: /content/editor
  categories: [image]
content:
  - name: editor
    label: æ–‡ç« 
    type: collection
    path: content/editor
    filename: index.md
    view:
      fields: [ title, date, draft ]
    fields:
      - { name: title, label: æ ‡é¢˜, type: string, required: true }
      - { name: draft, label: è‰ç¨¿, type: boolean, default: true }
      - { name: slug, label: å›ºå®šé“¾æ¥, type: string, required: true }
      - name: date
        label: æ—¥æœŸ
        type: date
        options:
          format: yyyy-MM-dd'T'HH:mm:ss
          time: true
      - name: categories
        label: åˆ†ç±»
        type: select
        list: true
        options:
          values:
            - ç”Ÿæ´»
            - ç¬é—´
            - æ³•å¾‹
            - ITäº’è”ç½‘
            - ç¤¾ä¼š
      - name: tags
        label: æ ‡ç­¾
        type: string
        list:
          min: 1
          max: 6
      - name: imageupload
        label: ä¸Šä¼ ç…§ç‰‡åŒºåŸŸ
        type: object
        list: true
        fields:
          - name: addimage
            label: æ·»åŠ ç…§ç‰‡
            type: image
            options:
              input: content/editor
              output: /content/editor
              categories: [image]
      - { name: image, label: ç‰¹è‰²å›¾ç‰‡åœ°å€, type: string, required: true }
      - { name: body, label: æ­£æ–‡, type: rich-text }
```